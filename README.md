# NanoGrid

The distribution is a parallel wrapper around the [Nanopolish](https://github.com/jts/nanopolish) framework The pipeline is composed of bash scripts. 

The current pipeline has been designed to run on the SGE scheduling system and has hard-coded grid resource request parameters. You must edit pilon.sh to match your grid options. It is, in principle, possible to run on other grid engines but will require editing all shell scripts to not use SGE_TASK_ID but the appropriate variable for your grid environment and editing the qsub commands in pilon.sh to the appropriate commands for your grid environment.

To run the pipeline you need to:

1. You must have a working installation of Nanopolish and symlink the directory from wherever you have placed Nanopolish. You must also have a working bwa mem and samtools in your path.

2. Run the pipeline specifying the input fasta assembly and reads. Note that only .fa extensions are currently supported and the reads fasta must have the location of the raw fast5 files as required by Nanopolish.

```
sh nano.sh asm.fa reads.fa
```

Each window generated by Nanopolish will be submitted to the grid. You can adjust the batch size parameter in nanopolish/scripts/nanopolish_makerange.py up or down to adjust the number of jobs:

```
# Do not change, must match nanopolish segment lengths
SEGMENT_LENGTH = 10000

# Ok to change this
SEGMENTS_PER_BATCH = 1
``
The pipeline is very rough and has undergone limited testing so user beware.

